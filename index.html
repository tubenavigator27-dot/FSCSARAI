<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Focus Academy Infinity</title>
    <style>
        /* --- CSS VARIABLES --- */
        :root {
            --primary: #4F46E5; /* Default Indigo */
            --bg: #F8FAFC;
            --card-bg: #ffffff;
            --text: #0F172A;
            --text-sec: #64748B;
            --success: #10B981;
            --danger: #EF4444;
            --gradient: linear-gradient(135deg, var(--primary), #9333EA);
        }

        body.dark-mode {
            --bg: #0F172A;
            --card-bg: #1E293B;
            --text: #F8FAFC;
            --text-sec: #94A3B8;
        }

        body {
            font-family: 'Segoe UI', sans-serif;
            background-color: var(--bg);
            color: var(--text);
            margin: 0; padding: 0; padding-bottom: 90px;
            user-select: none; -webkit-tap-highlight-color: transparent;
            transition: background 0.3s, color 0.3s;
        }

        /* --- LOGIN --- */
        #login-screen { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: var(--bg); z-index: 2000; display: flex; flex-direction: column; align-items: center; justify-content: center; }
        .scan-box { width: 100px; height: 100px; background: var(--card-bg); border-radius: 20px; display: flex; align-items: center; justify-content: center; margin-bottom: 20px; box-shadow: 0 10px 30px rgba(0,0,0,0.1); font-size: 40px; }
        .role-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; width: 85%; margin: 20px 0; }
        .role-card { background: var(--card-bg); padding: 15px; border-radius: 12px; text-align: center; border: 2px solid transparent; cursor: pointer; transition: 0.2s; color: var(--text); }
        .role-card.selected { border-color: var(--primary); background: rgba(79, 70, 229, 0.1); }
        .login-input { padding: 15px; width: 80%; border-radius: 10px; border: 1px solid #ddd; margin-bottom: 15px; background: var(--card-bg); color: var(--text); }

        /* --- LAYOUT --- */
        .page { display: none; padding: 20px; animation: fadeIn 0.3s; }
        .page.active { display: block; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

        header { background: var(--gradient); padding: 20px; color: white; border-radius: 0 0 25px 25px; display: flex; justify-content: space-between; align-items: center; box-shadow: 0 5px 15px rgba(0,0,0,0.2); }
        
        .grid-menu { display: grid; grid-template-columns: repeat(3, 1fr); gap: 12px; }
        .card { background: var(--card-bg); padding: 15px 5px; border-radius: 16px; text-align: center; box-shadow: 0 2px 8px rgba(0,0,0,0.05); cursor: pointer; min-height: 100px; display: flex; flex-direction: column; justify-content: center; align-items: center; }
        .card:active { transform: scale(0.95); }
        .card-icon { font-size: 26px; margin-bottom: 8px; }
        
        .btn-submit { width: 100%; background: var(--gradient); color: white; border: none; padding: 15px; border-radius: 12px; font-weight: bold; cursor: pointer; margin-top: 10px; }
        .btn-danger { background: var(--danger); }
        .btn-success { background: var(--success); }

        /* --- COMPONENTS --- */
        .list-item { background: var(--card-bg); padding: 15px; border-radius: 12px; margin-bottom: 10px; border-left: 4px solid var(--primary); display: flex; justify-content: space-between; align-items: center; box-shadow: 0 2px 5px rgba(0,0,0,0.05); }
        
        /* QUOTE WIDGET */
        .quote-box { background: linear-gradient(to right, #f6d365, #fda085); padding: 15px; border-radius: 15px; color: #333; margin-bottom: 15px; font-style: italic; position: relative; }
        
        /* THEME PICKER */
        .theme-grid { display: grid; grid-template-columns: repeat(4, 1fr); gap: 10px; margin-bottom: 20px; }
        .theme-ball { width: 40px; height: 40px; border-radius: 50%; cursor: pointer; border: 2px solid #ddd; }

        /* UTILS */
        input, textarea, select { width: 100%; padding: 12px; border: 1px solid #ddd; border-radius: 10px; box-sizing: border-box; margin-bottom: 10px; font-family: inherit; background: var(--card-bg); color: var(--text); }
        .bottom-nav { position: fixed; bottom: 0; width: 100%; background: var(--card-bg); display: flex; justify-content: space-around; padding: 12px 0; border-top: 1px solid #33333310; z-index: 1000; }
        .nav-item { text-align: center; color: var(--text-sec); flex: 1; font-size: 10px; }
        .nav-icon { font-size: 24px; display: block; margin-bottom: 2px; }
        
        /* POLLS */
        .poll-opt { padding: 10px; background: #eee; border-radius: 5px; margin-bottom: 5px; cursor: pointer; color:#333; }
        .poll-opt:hover { background: #ddd; }
    </style>
</head>
<body>

    <div id="login-screen">
        <div class="scan-box">ğŸ“</div>
        <h2>Focus Academy</h2>
        <p style="color:var(--text-sec); font-size:12px;">Infinity Edition</p>
        
        <div class="role-grid">
            <div class="role-card selected" onclick="setRole('student', this)">ğŸ‘¨â€ğŸ“ Student</div>
            <div class="role-card" onclick="setRole('parent', this)">ğŸ‘ª Parent</div>
            <div class="role-card" onclick="setRole('teacher', this)">ğŸ‘¨â€ğŸ« Teacher</div>
            <div class="role-card" onclick="setRole('admin', this)">ğŸ¢ Admin</div>
        </div>

        <input type="text" id="username" class="login-input" placeholder="Enter Name">
        <button class="btn-submit" style="width:80%;" onclick="login()">Login</button>
    </div>

    <div id="app-ui" style="display:none;">
        <header>
            <div>
                <h2 style="margin:0; font-size:18px;">Focus Academy</h2>
                <small id="header-role">Panel</small>
            </div>
            <button onclick="toggleDarkMode()" style="background:rgba(255,255,255,0.2); border:none; color:white; padding:5px 10px; border-radius:15px; font-size:12px;">ğŸŒ“ Theme</button>
        </header>

        <div id="dashboard" class="page active">
            <div class="quote-box">
                <span id="daily-quote">"Education is the passport to the future."</span>
                <button onclick="readNotice()" style="float:right; background:none; border:none; font-size:20px;">ğŸ”Š</button>
            </div>

            <div id="notice-board" style="margin-bottom:20px;"></div>
            <div id="menu-grid" class="grid-menu"></div>
        </div>

        <div id="poll-page" class="page">
            <h2>ğŸ—³ï¸ Live Poll</h2>
            <div class="card" style="width:auto; text-align:left; padding:15px; margin-bottom:10px;">
                <h3>Where should we go for the Trip?</h3>
                <div class="poll-opt" onclick="vote('Zoo')">ğŸ¯ Zoo (40%)</div>
                <div class="poll-opt" onclick="vote('Museum')">ğŸ›ï¸ Museum (20%)</div>
                <div class="poll-opt" onclick="vote('Water Park')">ğŸŒŠ Water Park (40%)</div>
            </div>
        </div>

        <div id="notes-page" class="page">
            <h2>ğŸ“’ Secret Diary</h2>
            <textarea id="private-note" rows="10" placeholder="Type your personal notes here..."></textarea>
            <button class="btn-submit" onclick="saveNote()">Save to Memory</button>
        </div>

        <div id="theme-page" class="page">
            <h2>ğŸ¨ App Theme</h2>
            <p>Select your favorite color:</p>
            <div class="theme-grid">
                <div class="theme-ball" style="background:#4F46E5;" onclick="setTheme('#4F46E5')"></div> <div class="theme-ball" style="background:#EF4444;" onclick="setTheme('#EF4444')"></div> <div class="theme-ball" style="background:#10B981;" onclick="setTheme('#10B981')"></div> <div class="theme-ball" style="background:#F59E0B;" onclick="setTheme('#F59E0B')"></div> </div>
        </div>

        <div id="help-page" class="page">
            <h2>ğŸ“ Emergency Help</h2>
            <div class="list-item" style="border-left-color:red" onclick="alert('Dialing 102...')"><b>ğŸš‘ Ambulance</b><b>102</b></div>
            <div class="list-item" style="border-left-color:orange" onclick="alert('Dialing 101...')"><b>ğŸš’ Fire</b><b>101</b></div>
            <div class="list-item" style="border-left-color:blue" onclick="alert('Dialing 100...')"><b>ğŸš“ Police</b><b>100</b></div>
            <div class="list-item" onclick="alert('Dialing Admin...')"><b>ğŸ« School Admin</b><b>+91...</b></div>
        </div>

        <div id="gallery-page" class="page">
            <h2>ğŸ“¸ Gallery</h2>
            <div style="display:grid; grid-template-columns:1fr 1fr; gap:10px;">
                <div style="background:#ffe4e6; height:100px; border-radius:10px; display:flex; align-items:center; justify-content:center;">Event 1</div>
                <div style="background:#dbeafe; height:100px; border-radius:10px; display:flex; align-items:center; justify-content:center;">Event 2</div>
            </div>
        </div>

        <div id="calc-page" class="page">
            <h2>ğŸ§® Calculator</h2>
            <input type="number" id="m-obt" placeholder="Obtained"><input type="number" id="m-tot" placeholder="Total">
            <button class="btn-submit" onclick="alert(((document.getElementById('m-obt').value / document.getElementById('m-tot').value)*100).toFixed(2) + '%')">Calc %</button>
        </div>

        <div id="bus-page" class="page"><h2>ğŸšŒ Bus</h2><div class="list-item"><b>Current Loc:</b> Sarai Market</div></div>
        <div id="file-page" class="page"><h2>ğŸ“‚ Files</h2><div class="list-item">Syllabus_2026.pdf</div></div>
        
        <div id="whiteboard-page" class="page"><h2>ğŸ¨ Whiteboard</h2><div style="border:1px solid #999; height:300px; background:white;"></div></div>
        <div id="qr-page" class="page"><h2>ğŸ”³ ID Card</h2><img src="https://api.qrserver.com/v1/create-qr-code/?size=150x150&data=Focus" style="display:block; margin:0 auto;"></div>
        <div id="chat-page" class="page"><h2>ğŸ’¬ Chat</h2><div style="height:300px; background:#f0f0f0; border-radius:10px; margin-bottom:10px;" id="chat-disp"></div><input id="chat-in"><button class="btn-submit" onclick="sendMsg()">Send</button></div>

        <div class="bottom-nav">
            <div class="nav-item active" onclick="goHome()"><span class="nav-icon">ğŸ </span>Home</div>
            <div class="nav-item" onclick="nav('gallery-page')"><span class="nav-icon">ğŸ“¸</span>Gallery</div>
            <div class="nav-item" onclick="nav('chat-page')"><span class="nav-icon">ğŸ’¬</span>Chat</div>
        </div>
    </div>

    <script>
        // --- STATE ---
        const db = {
            save: () => localStorage.setItem('focusInfDB', JSON.stringify(appData)),
            load: () => {
                const d = localStorage.getItem('focusInfDB');
                return d ? JSON.parse(d) : { notices: ["Welcome to Focus Academy!"], chats: [], note: "" };
            }
        };
        let appData = db.load();
        let currentUser = { role: 'student', name: '' };
        
        // --- AUTH ---
        function setRole(r, el) {
            currentUser.role = r;
            document.querySelectorAll('.role-card').forEach(c => c.classList.remove('selected'));
            el.classList.add('selected');
        }
        function login() {
            const n = document.getElementById('username').value;
            if(!n) return alert("Enter Name");
            currentUser.name = n;
            document.getElementById('login-screen').style.display = 'none';
            document.getElementById('app-ui').style.display = 'block';
            document.getElementById('header-role').innerText = currentUser.role.toUpperCase();
            document.getElementById('private-note').value = appData.note || ""; 
            renderDash();
        }
        function toggleDarkMode() { document.body.classList.toggle('dark-mode'); }

        // --- DASHBOARD ---
        function renderDash() {
            const grid = document.getElementById('menu-grid');
            grid.innerHTML = '';
            let items = [];

            // Universal Items
            items.push({i:'ğŸ’¬', l:'Chat', f:"nav('chat-page')"});
            items.push({i:'ğŸ¨', l:'Theme', f:"nav('theme-page')"}); // NEW
            items.push({i:'ğŸ“’', l:'Diary', f:"nav('notes-page')"}); // NEW
            items.push({i:'ğŸ“', l:'Help', f:"nav('help-page')"}); // NEW
            items.push({i:'ğŸ—³ï¸', l:'Vote', f:"nav('poll-page')"}); // NEW

            if(currentUser.role === 'student') {
                items.push({i:'ğŸ“¸', l:'Gallery', f:"nav('gallery-page')"});
                items.push({i:'ğŸ§®', l:'Calc', f:"nav('calc-page')"});
                items.push({i:'ğŸ¨', l:'Board', f:"nav('whiteboard-page')"});
                items.push({i:'ğŸšŒ', l:'Bus', f:"nav('bus-page')"});
                items.push({i:'ğŸ”³', l:'ID Card', f:"nav('qr-page')"});
                items.push({i:'ğŸ“‚', l:'Files', f:"nav('file-page')"});
            } else if(currentUser.role === 'admin') {
                items.push({i:'ğŸ“‚', l:'Files', f:"nav('file-page')"});
            }

            items.forEach(x => {
                grid.innerHTML += `<div class="card" onclick="${x.f}"><span class="card-icon">${x.i}</span><b>${x.l}</b></div>`;
            });
            
            let nHtml = '';
            appData.notices.forEach(n => nHtml += `<div class="list-item">${n}</div>`);
            document.getElementById('notice-board').innerHTML = nHtml;
        }

        // --- NEW FEATURES LOGIC ---
        function vote(option) {
            alert(`You voted for ${option}! Thanks.`);
        }

        function saveNote() {
            let t = document.getElementById('private-note').value;
            appData.note = t;
            db.save();
            alert('Diary Saved Securely!');
        }

        function setTheme(color) {
            document.documentElement.style.setProperty('--primary', color);
            alert('Theme Updated!');
        }

        function readNotice() {
            let text = "Welcome to Focus Academy. " + appData.notices.join(". ");
            let speech = new SpeechSynthesisUtterance(text);
            window.speechSynthesis.speak(speech);
        }

        function sendMsg() {
            let t = document.getElementById('chat-in').value;
            if(t) {
                document.getElementById('chat-disp').innerHTML += `<div style="background:white; padding:5px; margin:5px;"><b>${currentUser.name}:</b> ${t}</div>`;
                document.getElementById('chat-in').value = '';
            }
        }

        function nav(p) { 
            document.querySelectorAll('.page').forEach(e => e.classList.remove('active'));
            document.getElementById(p).classList.add('active');
        }
        function goHome() { nav('dashboard'); }

    </script>
</body>
</html>
